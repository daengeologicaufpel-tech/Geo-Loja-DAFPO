<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DAFPO - Loja Geológica</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:wght@400;700&family=Work+Sans:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

    <style>
        :root{--verde-principal:#3A5A40;--marrom-principal:#A0522D;--cor-fundo-claro:#F4F1EA;--cor-fundo-escuro:#252525;--cor-texto-claro:#EFEFEF;--cor-texto-escuro:#333333}*{-webkit-box-sizing:border-box;box-sizing:border-box;margin:0;padding:0}body{background-color:var(--cor-fundo-claro);color:var(--cor-texto-escuro);font-family:"Work Sans",sans-serif}.container{margin:0 auto;max-width:1200px;padding:0 20px}.main-header{background-color:var(--cor-fundo-escuro);border-bottom:3px solid var(--verde-principal);padding:15px 0;position:relative}.header-container{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.main-header .logo{height:50px}.main-header .logo img{display:block;height:100%}.header-nav ul{display:-webkit-box;display:-ms-flexbox;display:flex;gap:25px;list-style:none}.header-nav a{color:var(--cor-texto-claro);font-size:1rem;font-weight:700;letter-spacing:1px;padding:5px 0;text-decoration:none;-webkit-text-decoration-skip:objects;text-transform:uppercase;-webkit-transition:color .3s ease;transition:color .3s ease}.header-nav a:hover{color:var(--verde-principal)}.hamburger-menu{background:0 0;border:none;color:#fff;cursor:pointer;display:none;font-size:1.8rem;z-index:1001}.mobile-nav-menu{display:none}.products-section{padding:50px 20px}.product-grid{display:grid;gap:30px;grid-template-columns:repeat(auto-fit,minmax(260px,1fr))}.product-card{background-color:#fff;border-radius:4px;color:var(--cor-texto-escuro);display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;overflow:hidden;-webkit-box-shadow:0 4px 15px rgba(0,0,0,.05);box-shadow:0 4px 15px rgba(0,0,0,.05);text-decoration:none;-webkit-text-decoration-skip:objects;-webkit-transition:-webkit-transform .3s ease,-webkit-box-shadow .3s ease;transition:transform .3s ease,box-shadow .3s ease}.product-card:hover{-webkit-transform:translateY(-8px);transform:translateY(-8px);-webkit-box-shadow:0 8px 25px rgba(0,0,0,.1);box-shadow:0 8px 25px rgba(0,0,0,.1)}.card-media{-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:#f7f7f7;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;position:relative}.card-media img{-o-object-fit:cover;object-fit:cover;aspect-ratio:1/1;display:block;height:auto;-webkit-transition:opacity .3s ease;transition:opacity .3s ease;width:100%}.card-media .card-media-hover{left:0;opacity:0;position:absolute;top:0}.product-card:hover .card-media-hover{opacity:1}.card-info{border-top:1px solid #eee;padding:20px 15px;text-align:left}.card-info h3{font-family:"Roboto Condensed",sans-serif;font-size:1.1rem;font-weight:700;margin-bottom:8px}.card-info .price{color:var(--marrom-principal);font-size:1rem;font-weight:700}.main-footer{background-color:var(--cor-fundo-escuro);color:var(--cor-texto-claro);margin-top:40px;padding:40px 0 20px}.footer-grid{display:grid;gap:30px;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));margin-bottom:30px}.footer-column h4{color:#fff;font-size:1.1rem;font-weight:700;letter-spacing:1px;margin-bottom:15px;text-transform:uppercase}.footer-column ul{list-style:none}.footer-column ul li{margin-bottom:8px}.footer-column a,.footer-column p{color:#ccc;font-size:.9rem;text-decoration:none;-webkit-text-decoration-skip:objects;-webkit-transition:color .3s ease;transition:color .3s ease}.footer-column a:hover{color:#fff}.payment-icons{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;gap:8px}.payment-icons img{background-color:#fff;border-radius:3px;height:22px;padding:2px}.social-icons{display:-webkit-box;display:-ms-flexbox;display:flex;gap:15px}.social-icons a{color:#ccc;font-size:1.5rem;-webkit-transition:color .3s ease,-webkit-transform .3s ease;transition:color .3s ease,transform .3s ease}.social-icons a:hover{color:#fff;-webkit-transform:scale(1.1);transform:scale(1.1)}.footer-bottom{border-top:1px solid #444;color:#aaa;font-size:.8rem;padding-top:20px;text-align:center}@media (max-width:850px){.header-nav{display:none}.hamburger-menu{display:block}.header-container{position:relative;width:100%}.main-header .logo{-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);left:50%;position:absolute;top:50%}.mobile-nav-menu{-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:var(--cor-fundo-escuro);display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;gap:20px;height:calc(100vh - 84px);left:0;opacity:0;padding:40px 0;position:fixed;top:84px;-webkit-transform:translateY(-20px);transform:translateY(-20px);-webkit-transition:opacity .3s ease,visibility .3s ease,-webkit-transform .3s ease;transition:opacity .3s ease,visibility .3s ease,transform .3s ease;visibility:hidden;width:100%;z-index:1000}.mobile-nav-menu.is-active{opacity:1;-webkit-transform:translateY(0);transform:translateY(0);visibility:visible}.mobile-nav-menu a{color:#fff;font-size:1.2rem;font-weight:700;text-decoration:none;-webkit-text-decoration-skip:objects;text-transform:uppercase}.product-grid{gap:15px;grid-template-columns:repeat(2,1fr)}.card-info{padding:10px}.card-info h3{font-size:.9rem;margin-bottom:5px}.card-info .price{font-size:.9rem}.footer-grid{text-align:center}.social-icons,.payment-icons{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}}
    </style>
</head>
<body>
    <header class="main-header">
        <div class="container header-container">
            <nav class="header-nav left-nav">
                <ul>
                    <li><a href="#">Camisas</a></li>
                    <li><a href="#">Moletons</a></li>
                </ul>
            </nav>
            <div class="logo">
                <a href="/">
                    <img src="/images/dafpo-logo.png" alt="Logo DAFPO">
                </a>
            </div>
            <nav class="header-nav right-nav">
                <ul>
                    <li><a href="#">Acessórios</a></li>
                    <li><a href="#">Sobre</a></li>
                </ul>
            </nav>
            <button class="hamburger-menu" id="hamburger-btn" aria-label="Abrir menu">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </header>
    
    <nav class="mobile-nav-menu" id="mobile-menu">
        <a href="#">Camisas</a>
        <a href="#">Moletons</a>
        <a href="#">Acessórios</a>
        <a href="#">Sobre</a>
    </nav>

    <main>
        <section class="products-section">
            <div class="container">
                <div class="product-grid" id="product-grid-container">
                    <p style="text-align: center; grid-column: 1 / -1;">Carregando produtos...</p>
                </div>
            </div>
        </section>
    </main>

    <footer class="main-footer">
        </footer>
    
    <script>
        const hamburgerBtn = document.getElementById('hamburger-btn');
        const mobileMenu = document.getElementById('mobile-menu');
        if (hamburgerBtn && mobileMenu) {
            const icon = hamburgerBtn.querySelector('i');
            hamburgerBtn.addEventListener('click', () => {
                mobileMenu.classList.toggle('is-active');
                if (mobileMenu.classList.contains('is-active')) {
                    icon.classList.remove('fa-bars');
                    icon.classList.add('fa-times');
                } else {
                    icon.classList.remove('fa-times');
                    icon.classList.add('fa-bars');
                }
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            const productGrid = document.getElementById('product-grid-container');
            
            if (productGrid) {
                // DADOS DO SEU REPOSITÓRIO ATUALIZADOS
                const GITHUB_USER = "daengeologicaufpel-tech";
                const GITHUB_REPO = "Geo-Loja-DAFPO";
                
                const apiUrl = `https://api.github.com/repos/${GITHUB_USER}/${GITHUB_REPO}/contents/produtos`;

                async function fetchProducts() {
                    try {
                        const response = await fetch(apiUrl);
                        if (!response.ok) throw new Error(`Erro de rede: ${response.status}`);
                        
                        const files = await response.json();
                        if (files.message) throw new Error(`Erro do GitHub: ${files.message}`);

                        productGrid.innerHTML = ''; 
                        if (files.length === 0) {
                            productGrid.innerHTML = '<p style="text-align: center; grid-column: 1 / -1;">Nenhum produto cadastrado.</p>';
                            return;
                        }

                        const fetchPromises = files.map(file => 
                            fetch(file.download_url).then(res => res.text()).then(content => ({
                                content: content,
                                slug: file.name.replace(/\.md$/, '')
                            }))
                        );
                        
                        const productsData = await Promise.all(fetchPromises);

                        productsData.forEach(productData => {
                            const product = parseFrontmatter(productData.content);
                            if (product) {
                                displayProduct(product, productData.slug);
                            }
                        });

                    } catch (error) {
                        console.error('Falha ao buscar produtos:', error);
                        productGrid.innerHTML = `<p style="text-align: center; grid-column: 1 / -1;">Não foi possível carregar os produtos. Verifique se o repositório é público e os nomes estão corretos.</p>`;
                    }
                }

                function parseFrontmatter(markdownContent) {
                    const match = markdownContent.match(/---([\s\S]*?)---/);
                    if (!match) return null;
                    const frontmatter = {};
                    const lines = match[1].trim().split('\n');
                    lines.forEach(line => {
                        const separatorIndex = line.indexOf(':');
                        if (separatorIndex > -1) {
                            const key = line.slice(0, separatorIndex).trim();
                            const value = line.slice(separatorIndex + 1).trim().replace(/^['"]|['"]$/g, '');
                            frontmatter[key] = value;
                        }
                    });
                    return frontmatter;
                }

                function displayProduct(product, slug) {
                    const cardLink = document.createElement('a');
                    cardLink.href = `/produto/?slug=${slug}`;
                    cardLink.className = 'product-card';
                    cardLink.innerHTML = `
                        <div class="card-media">
                            <img class="card-media-main" src="${product.imagem_frente}" alt="${product.titulo}">
                            <img class="card-media-hover" src="${product.imagem_costas}" alt="${product.titulo} - Costas">
                        </div>
                        <div class="card-info">
                            <h3>${product.titulo}</h3>
                            <p class="price">R$ ${product.preco}</p>
                        </div>
                    `;
                    productGrid.appendChild(cardLink);
                }

                fetchProducts();
            }
        });
    </script>
</body>
</html>
